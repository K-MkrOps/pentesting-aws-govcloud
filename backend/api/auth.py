import jwt
from flask import Blueprint, jsonify, request
from backend.config.auth_config import JWT_SECRET

auth_bp = Blueprint('auth_bp', __name__)


@auth_bp.route('/api/auth/login', methods=['POST'])
def login():
    """
    Endpoint for user login
    """
    username = request.json['username']
    password = request.json['password']

    # code to authenticate user and generate JWT token
    token = jwt.encode({'username': username}, JWT_SECRET, algorithm='HS256')

    return jsonify({'token': token.decode('utf-8')})
