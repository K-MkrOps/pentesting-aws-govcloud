from flask import Blueprint, jsonify

pentesting_bp = Blueprint('pentesting_bp', __name__)

@pentesting_bp.route('/api/pentesting', methods=['GET'])
def get_pentesting_data():
    """
    Endpoint for getting data related to pentesting activities
    """
    # code to retrieve pentesting data from the database
    pentesting_data = {
        'scan_id': 1,
        'scan_type': 'Network',
        'scan_date': '2022-01-01',
        'scan_results': {
            'vulnerabilities': [
                {
                    'name': 'CVE-2022-1234',
                    'severity': 'High',
                    'description': 'Buffer overflow in application X',
                    'remediation': 'Upgrade to version Y'
                },
                {
                    'name': 'CVE-2022-5678',
                    'severity': 'Medium',
                    'description': 'Cross-site scripting vulnerability in application Z',
                    'remediation': 'Apply patch A'
                }
            ]
        }
    }
    
    return jsonify(pentesting_data)
